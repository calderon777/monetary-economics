---
title: "Week 1 Lecture - Monetary Economics"
author: "Your Name"
format:
  revealjs:
    theme: default
    slide-number: true
    chalkboard: true
    preview-links: auto
---

```{r setup}
#| include: false

# Configuration - CHANGE THIS FOR EACH LECTURE
ppt_filename <- "week1lecture2.pptx"

# Automated paths (don't change)
ppt_path <- file.path("ppt", ppt_filename)
img_dir <- file.path("ppt", "slides_png")
```

```{r convert-ppt-to-png}
#| include: false
#| eval: true

# Create output directory for slide images
dir.create(img_dir, recursive = TRUE, showWarnings = FALSE)

# Check if PPT file exists
if (!file.exists(ppt_path)) {
  stop(paste("PPT file not found:", ppt_path))
}

# Adjust if LibreOffice installed elsewhere
soffice <- '"C:/Program Files/LibreOffice/program/soffice.exe"'

# Export slides as PNG images (preserves all formatting)
cmd <- sprintf('%s --headless --convert-to png --outdir "%s" "%s"', 
               soffice, img_dir, ppt_path)
system(cmd, ignore.stdout = TRUE, ignore.stderr = TRUE)

# Wait a moment for file system to catch up
Sys.sleep(1)
```

```{r render-image-slides}
#| include: false
#| output: asis
#| eval: true

# Grab exported PNGs and sort them
imgs <- list.files(img_dir, pattern = "\\.png$", full.names = TRUE)

if (length(imgs) == 0) {
  cat("\n## Error\n\nNo slide PNGs found. Check LibreOffice export.\n")
} else {
  # Natural sort (slide_2 before slide_10)
  imgs <- imgs[order(nchar(imgs), imgs)]
  
  # Emit one Reveal slide per image as a background (best fidelity)
  for (i in seq_along(imgs)) {
    # Use relative path for the rendered site
    rel <- gsub("\\\\", "/", imgs[i])
    
    cat("\n---\n\n")
    cat(sprintf("## {background-image=\"%s\" background-size=\"contain\" background-position=\"center\"}\n", rel))
    cat("\n")
  }
}
```

<!-- 
INSTRUCTOR NOTES:
- Converts each PowerPoint slide to PNG (preserves ALL formatting)
- Each slide becomes a background image in Reveal.js
- Perfect fidelity to original presentation
- To add interactive elements (polls, quizzes), insert slides between the automated ones
- To update: change ppt_filename in setup chunk

EXAMPLE: Add a poll after slide 3
After the automated conversion runs, you can manually add:

---

## Quick Poll

<iframe
  src="YOUR-SLIDO-OR-MENTIMETER-URL"
  width="100%"
  height="520"
  frameborder="0"
  style="border:1px solid #ddd;border-radius:12px;">
</iframe>

---

Then the next PNG slide will continue automatically.
-->