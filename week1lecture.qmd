---
title: "Week 1 Lecture - Monetary Economics"
author: "Your Name"
format:
  revealjs:
    theme: default
    slide-number: true
    chalkboard: true
    preview-links: auto
---

```{r setup}
#| include: false

# Configuration - CHANGE THIS FOR EACH LECTURE
ppt_filename <- "week1lecture1.pptx"

# Automated paths (don't change)
ppt_path <- file.path("ppt", ppt_filename)
md_output <- file.path("ppt", sub("\\.(ppt|pptx)$", ".md", ppt_filename))
media_dir <- "ppt/media"
```

```{r convert-ppt}
#| include: false
#| eval: true

# Check if PPT file exists
if (!file.exists(ppt_path)) {
  stop(paste("PPT file not found:", ppt_path))
}

# Run pandoc conversion
system(sprintf('pandoc "%s" -o "%s" --extract-media=%s', 
               ppt_path, md_output, media_dir))
```

```{r clean-content}
#| include: false
#| eval: true

# Function to clean markdown for Reveal.js
clean_for_revealjs <- function(md_file) {
  lines <- readLines(md_file, warn = FALSE)
  
  # Replace level 1 headers with level 2 (for slides)
  lines <- gsub("^# ", "## ", lines)
  
  # Ensure proper slide breaks
  lines <- gsub("^---$", "\n---\n", lines)
  
  # Fix image paths (if needed)
  lines <- gsub("!\\[\\]\\(ppt/media/", "![](media/", lines)
  
  # Remove empty lines at the start
  lines <- lines[cumsum(nchar(trimws(lines)) > 0) > 0]
  
  return(lines)
}

# Run cleaning
cleaned_lines <- clean_for_revealjs(md_output)
```

```{r render-slides}
#| include: false
#| output: asis
#| eval: true

# Output the cleaned content directly as slides
cat(paste(cleaned_lines, collapse = "\n"))
```

<!-- 
INSTRUCTOR NOTES:
- The conversion happens automatically when you render
- Students only see the slides below
- To update: change ppt_filename in setup chunk
- All conversion code is hidden with include: false
-->