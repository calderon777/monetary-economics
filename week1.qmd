---
title: "End of Week 1 Quiz"
format: html
execute:
  echo: false
---

:::callout-note
- This quiz is for **self-assessment**.
- Your answers are **not automatically collected**.
- Select the best answer for each question.
:::

```{r}
#| echo: false
library(webexercises)
```

<!-- FEEDBACK SCRIPT: interactive quiz with self-assessment -->
```{=html}
<script>
(function () {
  // 1) Configure your Google Apps Script Web App URL here.
  //    Example: https://script.google.com/macros/s/XXXXXXXXXXXX/exec
  const ENDPOINT = "https://script.google.com/macros/s/AKfycbysCOTW2ZLw5ruYY84Y-o0zB7nt0jkowiC3OoKJSdh2OYv-ZXa_1vTb_TU4BYwcwSZ0Jw/exec";

  const norm = s => (s || "").replace(/\s+/g, " ").trim();

  function getSelectedLabelText(qEl) {
    const input = qEl.querySelector('input[type="radio"]:checked');
    if (!input) return "";
    const label = input.closest('label') || document.querySelector('label[for="' + input.id + '"]');
    return label ? norm(label.textContent) : "";
  }

  function clearFeedback(qEl) {
    qEl.querySelectorAll("label").forEach(l => l.classList.remove("is-correct", "is-incorrect"));
    const line = qEl.querySelector(".quiz-feedback-line");
    if (line) {
      line.textContent = "";
      line.classList.add("hidden");
    }
  }

  function setFeedback(qEl, isCorrect) {
    const line = qEl.querySelector(".quiz-feedback-line");
    if (!line) return;
    line.textContent = isCorrect ? "Correct." : "Incorrect.";
    line.classList.remove("hidden");
  }

  async function postAttempt(payload) {
    // Do not attempt POST if ENDPOINT is not configured
    if (!ENDPOINT || ENDPOINT.includes("PASTE_YOUR_")) return;

    try {
      await fetch(ENDPOINT, {
        method: "POST",
        mode: "no-cors",
        keepalive: true,
        body: JSON.stringify(payload)
      });
    } catch (err) {
      console.warn("Could not save attempt:", err);
    }
  }

  async function loadLeaderboard(quizName) {
    const table = document.getElementById("leaderboard");
    if (!table) return;

    // If not configured, show a friendly message and stop.
    if (!ENDPOINT || ENDPOINT.includes("PASTE_YOUR_")) {
      table.innerHTML = "<tr><td>Leaderboard is not configured yet. Add your Apps Script URL in the page source.</td></tr>";
      return;
    }

    try {
      const res = await fetch(ENDPOINT, { method: "GET" });
      if (!res.ok) throw new Error("HTTP " + res.status);
      const rows = await res.json();

      // Filter for this quiz only (defensive: older rows may not have the fields)
      const filtered = (rows || []).filter(r => String(r.quiz || "") === String(quizName));

      // Keep best score per nickname
      const best = new Map();
      filtered.forEach(r => {
        const nick = String(r.nickname || "").trim();
        if (!nick) return;
        const score = Number(r.score);
        const total = Number(r.total);
        const ts = new Date(r.timestamp || 0).getTime();

        const prev = best.get(nick);
        if (!prev || score > prev.score || (score === prev.score && ts < prev.ts)) {
          best.set(nick, { nickname: nick, score, total, ts });
        }
      });

      const leaderboard = Array.from(best.values())
        .sort((a, b) => (b.score - a.score) || (a.ts - b.ts))
        .slice(0, 10);

      if (leaderboard.length === 0) {
        table.innerHTML = "<tr><td>No attempts recorded yet.</td></tr>";
      } else {
        table.innerHTML =
          "<tr><th>Rank</th><th>Nickname</th><th>Score</th></tr>" +
          leaderboard.map((r, i) =>
            "<tr><td>" + (i + 1) + "</td><td>" + String(r.nickname) + "</td><td>" + r.score + " / " + r.total + "</td></tr>"
          ).join("");
      }
    } catch (err) {
      table.innerHTML = "<tr><td>Could not load leaderboard.</td></tr>";
      console.warn("Leaderboard error:", err);
    }
  }

  async function submitQuiz() {
    const nicknameEl = document.getElementById("nickname");
    const resultEl = document.getElementById("quiz-result");
    const submitBtn = document.getElementById("quiz-submit");

    const nickname = (nicknameEl?.value || "").trim();
    if (!nickname) {
      alert("Please enter a nickname before submitting.");
      nicknameEl?.focus();
      return;
    }

    // Lock submit to avoid double posting
    if (submitBtn) submitBtn.disabled = true;

    let score = 0;
    let total = 0;
    const details = {};

    const questions = Array.from(document.querySelectorAll(".mcq-we-q"));

    // Clear any prior feedback first (important if student re-submits)
    questions.forEach(clearFeedback);

    questions.forEach((qEl, idx) => {
      total += 1;
      const keyEl = qEl.querySelector(".mcq-key");
      const correct = norm(keyEl?.getAttribute("data-correct") || "");
      const selected = getSelectedLabelText(qEl);

      const isCorrect = selected && (selected === correct);
      if (isCorrect) score += 1;

      details["Q" + (idx + 1)] = { selected, correct, ok: isCorrect ? 1 : 0 };

      // Mark only after submit
      if (selected) {
        const input = qEl.querySelector('input[type="radio"]:checked');
        const label = input?.closest('label') || (input ? document.querySelector('label[for="' + input.id + '"]') : null);
        if (label) label.classList.add(isCorrect ? "is-correct" : "is-incorrect");
      }
      setFeedback(qEl, isCorrect);
    });

    if (resultEl) {
      resultEl.textContent = "Submitted. Your score: " + score + " / " + total;
    }

    // Persist attempt (best practice: store what you need; nickname only = low GDPR footprint)
    await postAttempt({
      timestamp: new Date().toISOString(),
      nickname,
      quiz: "Week1",
      score,
      total,
      details
    });

    // Refresh leaderboard after a successful submit (or best-effort submit)
    await loadLeaderboard("Week1");

    // Re-enable submit (optional — keep disabled if you want one attempt only)
    if (submitBtn) submitBtn.disabled = false;
  }

  // Expose submitQuiz globally for the button onclick
  window.submitQuiz = submitQuiz;

  // Add a feedback line container to each question if it doesn't exist
  document.addEventListener("DOMContentLoaded", function () {
    document.querySelectorAll(".mcq-we-q").forEach(qEl => {
      if (!qEl.querySelector(".quiz-feedback-line")) {
        const line = document.createElement("div");
        line.className = "quiz-feedback-line hidden";
        qEl.appendChild(line);
      }
    });

    loadLeaderboard("Week1");
  });
})();
</script>
```



<div class="mcq-we">


<div class="quiz-controls">
  <input id="nickname" type="text" placeholder="Enter nickname (e.g., DataCelebrity42)" autocomplete="off" />
  <button id="quiz-submit" type="button" onclick="submitQuiz()">Submit</button>
  <button type="button" onclick="location.reload()">Reset</button>
</div>

<div id="quiz-result"></div>

<details>
  <summary><strong>Leaderboard (Top 10)</strong></summary>
  <table id="leaderboard"></table>
</details>

<div class="mcq-we-q">
**1) According to some accounts, an early form of accounting that recorded national wealth was represented by:**  
`r webexercises::longmcq(c("Cattle", "Paper currency", answer = "Tally sticks", "Jewellery"))`
<span class="mcq-key" data-correct="Tally sticks"></span>
<details class="hint"><summary>Hint</summary>Carved marks as receipts.</details>
</div>

<div class="mcq-we-q">
**2) In an economy with 6 goods, the number of possible exchange ratios would be:**  
`r webexercises::longmcq(c("6", "12", answer = "15", "30"))`
<span class="mcq-key" data-correct="15"></span>
<details class="hint"><summary>Hint</summary>It’s n(n-1)/2.</details>
</div>

<div class="mcq-we-q">
**3) A currency based on fiat money differs from one based on commodity money by the fact that:**  
`r webexercises::longmcq(c(
  "The former uses paper while the latter uses metallic coins",
  answer = "The bearer of commodity money has a claim to an equivalent value of the commodity itself, while the bearer of fiat money has no such claim",
  "The former is issued by a central bank while the latter is not",
  "The former circulates as a medium of exchange only because it is universally accepted as playing this role while the latter does not require such acceptance"
))`
<span class="mcq-key" data-correct="The bearer of commodity money has a claim to an equivalent value of the commodity itself, while the bearer of fiat money has no such claim"></span>
<details class="hint"><summary>Hint</summary>One is redeemable, the other is not.</details>
</div>

<div class="mcq-we-q">
**4) Which of the following properties is an objective criterion for something to serve as a medium of exchange?**  
`r webexercises::longmcq(c("Marketability", "Backing by a Central Bank", "Predictability of exchange value", answer = "Durability"))`
<span class="mcq-key" data-correct="Durability"></span>
<details class="hint"><summary>Hint</summary>Think physical robustness.</details>
</div>

<div class="mcq-we-q">
**5) Which of the following statements reflects the debate between Keynesian and Classical economists?**  
`r webexercises::longmcq(c(
  answer = "The use of money as a store of value can lead to profound implications for macroeconomic stability",
  "Every trader is willing to accept money as a means of payment precisely because every other trader is willing to accept money as a means of payment",
  "The use of a common unit of account for all items traded in an economy makes it easier to keep track of the exchange ratios between these items",
  "The use of money as a medium of exchange automatically makes it a store of value"
))`
<span class="mcq-key" data-correct="The use of money as a store of value can lead to profound implications for macroeconomic stability"></span>
<details class="hint"><summary>Hint</summary>Liquidity preference vs neutrality.</details>
</div>

</div>
